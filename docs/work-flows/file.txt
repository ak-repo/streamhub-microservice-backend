Design decision (production best practice):
Large file uploads are best handled with presigned uploads (client uploads directly to MinIO/S3). This avoids buffering files in your gateway, reduces memory/CPU, and works reliably with load-balancers. The gateway + gRPC service coordinate the flow:

Client asks the Gateway for an upload URL (/upload-url).

Gateway calls the Files gRPC service (GetUploadURL) which:

Generates a unique object key

Creates a presigned PUT URL from MinIO (short expiry)

Returns object key + presigned URL

Client PUTs file to MinIO using that presigned URL (direct to MinIO).

Client notifies gateway (/upload/complete) with metadata (owner_id, filename, size, mime, object_key).

Gateway calls Files gRPC CompleteUpload which:

Verifies object exists in MinIO (optional)

Saves metadata into Postgres (FK to users)

Returns File record

This flow meets production needs: streaming is delegated to S3/MinIO; your services remain stateless and fast.




⭐ New Architecture (Production Standard)
Flow: File Upload
React → Gateway → gRPC → GetUploadURL → S3 Presigned PUT  
React → uploads file directly to S3  
React → Gateway → gRPC → CompleteUpload → DB Save

Flow: File Download
React → Gateway → gRPC → GetDownloadURL → S3 Presigned GET URL  
React → directly downloads from S3  